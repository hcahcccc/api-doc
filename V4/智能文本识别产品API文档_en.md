# Shumei Intelligent Text Recognition Product API Documentation


## Request Parameters

### Request URL:

| Cluster | URL | Supported Product List |
| --- | --- | --- |
| Beijing | `http://api-text-bj.fengkongcloud.com/text/v4` | Chinese Text |
| Shanghai | `http://api-text-sh.fengkongcloud.com/text/v4` | Chinese Text |
| USA (Virginia) | `http://api-text-fjny.fengkongcloud.com/text/v4` | Chinese Text <br/> International Text |
| Singapore | `http://api-text-xjp.fengkongcloud.com/text/v4` | Chinese Text <br/> International Text |

### Character Encoding Format:

`UTF-8` character set encoding

### Request Method:

`POST`

### Suggested Timeout Duration:

1s

### Request Parameters:

Placed in the HTTP Body, in JSON format, with specific parameters as follows:

| **Request Parameter Name** | **Type** | **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| accessKey | string | API authentication key | Y | Provided by Shumei |
| appId | string | Application identifier | Y | Used to distinguish applications, needs to be activated by contacting Shumei service, please use the value provided separately by Shumei |
| eventId | string | Event identifier | Y | Needs to be activated by contacting Shumei service, please use the value provided separately by Shumei |
| type | string | Type of risk detection | Y | Optional values:<br/>`POLITY`: Political detection<br/>`VIOLENT`: Terrorism detection<br/>`BAN`: Prohibited detection<br/>`EROTIC`: Pornographic detection<br/>`DIRTY`: Abusive detection<br/>`ADVERT`: Advertisement detection<br/>`PRIVACY`: Privacy detection<br/>`ADLAW`: Advertisement law detection<br/>`MEANINGLESS`: Meaningless detection<br/>`TEXTRISK`: General risk detection (includes:<br/>Political, Terrorism, Prohibited, Pornographic, Abusive, Advertisement, Privacy, Advertisement law, Meaningless)<br/>`FRUAD`: Online fraud detection<br/>`UNPOACH`: High-value user anti-poaching detection<br/>`TEXTMINOR`: Minor content detection<br/>The above types can be combined with underscores, such as: `TEXTRISK_FRUAD`<br/>Combination of types takes the union, such as: `TEXTRISK_POLITY` is processed as general risk detection |
| data | json_object | Request data content | Y | Maximum 1MB, [see data parameters](#data) |
| kbType | string | Knowledge base type | N | The knowledge base supports a maximum input length of 510 characters, exceeding this will result in the text content of this request not matching the knowledge base. If you need to activate this feature, please contact Shumei business<br/>Optional values:<br/>`PKB`: Enable political knowledge base function<br/> |
| translationTargetLang | string | Translation target language | N | Translate the input text into the target language. If you need to activate this feature, please contact Shumei business<br/>Optional values:<br/>`zh`: Chinese<br/>`en`: English<br/>|

<span id="data"> The content of data is as follows:</span>

| **Request Parameter Name** | **Type** | **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| text | string | Text to be detected | Y | The maximum number of characters per request is 10,000, an error will be reported if it exceeds 10,000 characters.<br/>If the nickname field is passed, the text + nickname content will be checked simultaneously.|
| tokenId | string | User account identifier, it is recommended to use your company's user UID (can be encrypted) to generate it yourself, used to identify the unique identity of the user for risk control of behaviors such as spamming and advertising.<br/>If there is no user UID scenario, it is recommended to use a unique data identifier to pass the value | Y | A string of up to 64 characters composed of numbers, letters, underscores, and hyphens |
| lang | string | Language of the text content to be detected | N | Optional values and corresponding languages are as follows:<br/>`zh`: Chinese<br/>`en`: English<br/>`ar`: Arabic<br/>`hi`: Hindi<br/>`es`: Spanish<br/>`fr`: French<br/>`ru`: Russian<br/>`pt`: Portuguese<br/>`id`: Indonesian<br/>`de`: German<br/>`ja`: Japanese<br/>`tr`: Turkish<br/>`vi`: Vietnamese<br/>`it`: Italian<br/>`th`: Thai<br/>`tl`: Filipino<br/>`ko`: Korean<br/>`ms`: Malay<br/>`auto`: Automatically detect language type<br/>Default value is zh, domestic cluster customers can omit or use zh; for overseas text content, if the language cannot be distinguished, it is recommended to use auto, the system will automatically detect the language type |
| nickname | string | User nickname | N | Check the risk of nickname content, length limit is 150 characters, the excess part will be truncated |
| ip | string | IP address | N | The public IPv4 or IPv6 address of the user sending the text |
| deviceId | string | Shumei device identifier | N | The unique device identifier generated by Shumei device fingerprint |
| extra | json_object | Auxiliary parameters | N | Used to assist in text detection related information, [see extra parameters](#extra) |
| dataId | string | Data identifier | N | Data identifier |

<span id="extra">The content of each element in the extra array in data is as follows:</span>

| **Request Parameter Name** | **Type** | **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| receiveTokenId | string | TokenId of the message receiver in private chat scenarios | N | A string of up to 64 characters composed of numbers, letters, underscores, and hyphens, required when eventId value is `message` |
| topic | string | Can be topic number, book review area number, forum post number | N | When the data passed in is a post (eventId value is article), it is recommended to pass in to enable context recognition function, otherwise, the context cannot be associated |
| atId | string | TokenId of the user being @ in group chat scenarios | N | A string of up to 64 characters composed of numbers, letters, underscores, and hyphens, required when eventId value is `groupChat` |
| room | string | Live room/game room number | N | When the data passed in is a live room, chat room, etc. (eventId value is groupChat), it is recommended to pass in to enable context recognition function, otherwise, the context cannot be associated |
| sex | int | Gender | N | Used for user gender, optional values:<br/>`0`: Male<br/>`1`: Female<br/>`2`: Unknown |
| passThrough | Json | Pass-through field | N | The content of this field will be returned along with the return value |

## Return Results

### Return Results

Placed in the HTTP Body, in JSON format, with specific parameters as follows:

| **Parameter Name** | **Type** | **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| code | int| Return code | Y | `1100`: Success<br/>`1901`: QPS limit exceeded<br/>`1902`: Invalid parameter<br/>`1903`: Service failure<br/>`1905`: Character limit exceeded<br/>`9101`: Unauthorized operation |
| message | string | Return code description | Y | Corresponds to code:<br/>Success<br/>QPS limit exceeded<br/>Invalid parameter<br/>Service failure<br/>Character limit exceeded<br/>Unauthorized operation |
| requestId | string | Request identifier | Y | The unique identifier of the data for this request, used for troubleshooting and performance optimization, strongly recommended to save |
| riskLevel | string | Disposal suggestion | Y | Possible return values:<br/>`PASS`: Normal, recommended to pass directly<br/>`REVIEW`: Suspicious, recommended for manual review<br/>`REJECT`: Violation, recommended to intercept directly |
| riskLabel1| string | Primary risk label | Y | Primary risk label, returns `normal` when riskLevel is `PASS` |
| riskLabel2| string | Secondary risk label | Y | Secondary risk label, empty when riskLevel is `PASS` |
| riskLabel3| string | Tertiary risk label | Y | Tertiary risk label, empty when riskLevel is `PASS` |
| riskDescription | string | Risk reason | Y | "Normal" when riskLevel is `PASS` |
| riskDetail | json_object| Risk details | Y | Risk details, [see riskDetail parameters](#riskDetail)|
| tokenLabels | json object| Auxiliary information | Y | Account risk profile label information, see details below. [see tokenLabels parameters](#tokenLabels) |
| auxInfo| json_object| Auxiliary information | Y | [see auxInfo parameters](#auxlnfo)|
| allLabels | json_array | Auxiliary information | Y | All hit risk labels and detailed information. [see allLabels parameters](#allLabels) |
| businessLabels | json_array | Auxiliary information | Y | All hit business labels and detailed information. [see businessLabels parameters](#businessLabels) |
| tokenProfileLabels | json_array | Auxiliary information | N | Attribute account labels. [see account label parameters](#tokenProfileLabels) |
| tokenRiskLabels | json_array | Auxiliary information | N | Risk account labels. [see account label parameters](#tokenProfileLabels) |
| langResult | json_object | Language information | N | Language information. [see language information parameters](#langResult) |
| kbDetail | json_object| Knowledge base details | N | Knowledge base details, [see kbDetail parameters](#kbDetail)|
| finalResult       | int  | Whether it is the final result | Y | Value is 1, your company can directly use the return result for disposal, distribution, and other downstream scenarios<br/>Value is 0, indicating that the result is an intermediate result of Shumei risk control, and it needs to be checked again by Shumei human review before returning to your company |
| resultType       | int  | Whether the current result is a machine review or human review result |Y|0: Machine review, 1: Human review |
| disposal       | json_object  | Disposal and mapping results | N | Shumei can return according to your company's label system and identification; if the custom label system is not configured, this field will not be returned |

<span id="disposal">The structure of disposal is as follows:</span>

| **Return Result Parameter Name** | **Parameter Type** | **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| riskLevel | string | Disposal suggestion | Yes | If your company has its own disposal rules, Shumei can configure and return the corresponding disposal suggestions according to your company's disposal logic; if the rule label is not mapped, the default disposal suggestion will be returned |
| riskLabel1 | string | Mapped primary risk label | Y | Primary risk label, when Shumei label is not mapped to custom label, and riskLevel under disposal is PASS, riskLabel1 value is normal |
| riskLabel2 | string | Mapped secondary risk label | Y | Secondary risk label, when Shumei label is not mapped to custom label, and riskLevel under disposal is PASS, riskLabel2 value is empty |
| riskLabel3 | string | Mapped tertiary risk label | Y | Tertiary risk label, when Shumei label is not mapped to custom label, and riskLevel under disposal is PASS, riskLabel3 value is empty |
| riskDescription | string | Mapped risk reason | Y | When riskLevel is PASS, it is "Normal" |
| riskDetail | json_object | Mapped risk details | Y | [see riskDetail parameters](#riskDetail) |

<span id="langResult">The structure of langResult is as follows:</span>

| **Parameter Name** | **Type** | **Parameter Description** | **Required** | **Specification**                                                     |
| ------------ | -------- | ------------ | ------------ | ------------------------------------------------------------ |
| [detectedLang](/docs/tj/text/lang) | string   | Language detection result | N            | When the value of lang is auto in the international text product, this field is returned. The value is a standard language code table, such as: "zh", "en", "ar", etc. |
| translatedText | string   | Text translation result   | N | When translationTargetLang is passed, this field is returned. The value is the translated text. |

<span id="auxlnfo">The auxInfo field is as follows:</span>

| **Parameter Name**| **Type** | **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| filteredText| string | Auxiliary information | N| Text with risk segments replaced by * <br/> |
| passThrough | json_object | Pass-through field | No | The content of this field is the same as the value of passThrough in the extra of the request parameter data. |
| contactResult | json_array | Auxiliary information | N| Contact information recognition result, including the string type and content of the recognized WeChat, QQ, and phone numbers. [see contactResult parameters](#contactResult) |
| contextText | string | Auxiliary information | N | Returned when context is effective. |
| unauthorizedType | string | Auxiliary information | N | Unauthorized type. |

<span id="contactResult">In auxInfo, the content of each element in the contactResult array is as follows:</span>

| **Parameter Name**| **Type** | **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| contactType | int| Auxiliary information | N| Contact type, optional values range from 【0-3】, details are as follows:<br/>`0`: Phone number <br/>`1`: QQ number <br/>`2`: WeChat number  |
| contactString | string | Auxiliary information | N| Contact string |

<span id="riskDetail">The content of riskDetail is as follows:</span>

| **Parameter Name** | **Type** | **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| matchedLists | json_array | Auxiliary information | N| Hit customer-defined list. [see matchedLists parameters](#matchedLists) |
| riskSegments | json_array | Auxiliary information, high-risk content segment detection text contains risk content such as political, terrorism, prohibited, advertisement law, etc. | N| [see riskSegments parameters](#riskSegments) |

<span id="matchedLists">In riskDetail, the content of each element in the matchedLists array is as follows:</span>

| **Parameter Name** | **Type** | **Parameter Description** | **Required** | **Specification**|
| --- | --- | --- | --- | --- |
| name | string | Auxiliary information | N| Name of the hit list|
| words| json_array | Auxiliary information | N| Array of hit sensitive words. [see words parameters](#words) |

<span id="words">In matchedLists, the content of each element in the words array is as follows:</span>

| **Parameter Name** | **Type**| **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| word | string| Auxiliary information | N| Hit sensitive word |
| position | int_array | Auxiliary information | N| Position of the sensitive word |

<span id="riskSegments">In riskDetail, the content of riskSegments is as follows:</span>

| **Parameter Name** | **Type**| **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| segment| string| Auxiliary information | N| High-risk content segment |
| position | int_array | Auxiliary information | N| Position of the high-risk content segment |

<span id="tokenLabels">The details of tokenLabels are as follows:</span>

| **Parameter Name** | **Type**| **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| UGC_account_risk | json_object | Auxiliary information | N| UGC content related risk. [see UGC_account_risk parameters](#UGC_account_risk) |

<span id="UGC_account_risk">In tokenLabels, the details of UGC_account_risk are as follows:</span>

| **Parameter Name**| **Type** | **Parameter Description** | **Required** | **Specification**|
| --- | --- | --- | --- | --- |
| sexy_risk_tokenid | float| Auxiliary information | N| Pornographic account risk score, value range [0-1] |

<span id="allLabels">The content of allLabels is as follows:</span>

| **Parameter Name** | **Type** | **Parameter Description** | **Required** | **Specification** |
| --- | --- | --- | --- | --- |
| riskLabel1 | string | Required when allLabels is not empty | Y | Primary risk label |
| riskLabel2 | string | Required when allLabels is not empty | Y | Secondary risk label|
| riskLabel3 | string | Required when allLabels is not empty | Y | Tertiary risk label|
| riskDescription| string | Required when allLabels is not empty | Y | Risk reason|
| probability| float| Confidence | Y | Optional values range from 0 to 1, the larger the value, the higher the confidence. Note: Required when allLabels is not empty |
| riskDetail | json_object| Risk details | Y | The format is the same as the upper-level riskDetail structure. Note: Required when allLabels is not empty |
| riskLevel | string | Risk level | Y | Possible return values:<br/>`REVIEW`: Suspicious<br/>`REJECT`: Violation |

<span id="businessLabels">The content of businessLabels is as follows:</span>

| Parameter Name            | Type        | Parameter Description                                                     | Required | Specification         |
| ------------------- | ----------- | ------------------------------------------------------------ | -------- | ------------ |
| businessLabel1      | string      | Required when businessLabels is not empty                                     | Y        | Primary business label |
| businessLabel2      | string      | Required when businessLabels is not empty                                     | Y        | Secondary business label |
| businessLabel3      | string      | Required when businessLabels is not empty                                     | Y        | Tertiary business label |
| businessDescription | string      | Required when businessLabels is not empty                                     | Y        | Label description     |
| probability         | float       | Required when businessLabels is not empty<br/>Optional values range from 0 to 1, the larger the value, the higher the confidence | Y        | Confidence       |
| business